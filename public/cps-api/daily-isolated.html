<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Daily Quarantines by School</title>
  <meta name="author" content="Nathan Goldbaum">
  <meta name="description" content="Get weekly data on COVID actionable cases in CPS.">
  <link rel="stylesheet" type="text/css" href="/assets/css/shell.css">
  <link rel="stylesheet" type="text/css" href="/assets/css/api.css">
  <style>
    output table tbody td {padding-right: 2em;}
    output table tbody td:first-child {text-align:left;}
    output table thead th {padding-left: 1ch;}
  </style>

</head>
<body>
  <header>
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <h1>Daily Quarantines by School*</h1>
    <p>
    This page queries the CPS API for the history of quarantine/isolation data from two endpoints: <a href="https://api.cps.edu/schoolprofile/cps/SchoolProfileBasicData?SchoolYear=2022">School Basic Profile</a> (for student count) and <a href="https://api.cps.edu/health/cps/SchoolNoAdmittanceSummary">School No Admittance Summary</a> (for all quarantine numbers). You can query for any day in which any school has recorded cases this school year, according to CPS data. The default value is the most recent day (generally, yesterday). Use the dropdown to change the date selected. Results are ordered by highest percentage of students in quarantine/isolation. To copy this data into another spreadsheet for analysis, click the button that says “copy to clipboard.”
    </p>
    <details style="margin: 1.1em 0 1.6em;">
      <summary style="font-weight: bold;">*Notes on data sources <span style="font-weight:normal;">(click to show)</span></summary>
    <p>To the best of our knowledge, CPS does not currently report the number of adults working in a school on any public data source. In addition, we are not certain that the student population numbers they report in their school profile API are updated regularly. Finally, the school-by-school quarantine data that CPS publishes through their API does not currently distinguish between adults quarantined and students quarantined. For all these reasons, the percentage reported here may differ both from the percentage reported by CPS and from the actual percentage of students and staff in quarantine at any given school.</p>
    <p>In addition, it could be argued that the combined adults+staff in quarantine should be divided by our (not current) figure for adult population plus students, unlike the current number that divides only by student population. True, the current method may skew a bit high. However, district-wide adult percentages during every day outside winter break and the period of CTU’s job action in January were lower than student percentages (by an average of 1.3%, so far). So, combining the adult and student populations would also likely skew the resulting percentage &mdash; in this instance lower, rather than higher.
    </p>
    </details>
    <h2>Query activity log</h2>
    <div style="background: #ddd; padding: 10px;">
    <output id="queryOutput"></output>
    </div>
    <p id="buttons">
      <button id="lookup" type="submit">Resend Query</button>
      <label for="date">Show data for date: </label>
      <select name="date-select" id="date">
      </select>
      <button class="btn" data-clipboard-target="#dataOutput">
        <img src="/assets/img/copied.svg" alt="" style="height: 1.6em; margin: 8px;"/>
        <span>Copy table to clipboard</span>
      </button>
      <span id="copiedMsg"></span>
    </p>
    <output id="dataOutput"></output>
  </main>

  <footer>
    <p>If you have any issues, <a href="mailto:NathanGoldbaum@ctulocal1.org?subject=Tools website">email Nate Goldbaum</a> or call his cell phone at 773-490-5996.
    </p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script>
  <script type="text/javascript" src="/assets/js/cps-api-daily-isolated.js"></script>
  <script type="text/javascript">
   if (document.addEventListener) document.addEventListener("DOMContentLoaded", autorun, false);
   else if (document.attachEvent) document.attachEvent("onreadystatechange", autorun);
   else window.onload = autorun;
  </script>
</body>
</html>
